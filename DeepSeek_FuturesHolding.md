
提示词：

我们进行约定，后续提示词中，我使用Markdown语法<!-- -->的部分，是我自己的注释，你需要忽略解读我的注释。

<!-- 
处理流程：

*  网页获得PDF数据，交给DS处理

* 将DS处理后的数据拷贝到Excel，控制Excel格式，然后按需打印。

修改记录：
* 2025.03.02 考虑添加表格示例，以方面GPT进行表格展示。效果不好，还是使用文字说明。初始投喂数据：
  **  期货品种表.xlsx，PDF文件
** 
-->

1. 模版初始化：
从文件“期货品种表.xlsx”文件，获得“期货数据全表”，并记住这个数据表。文件“净持仓模版.xlsx”是你最终表格输出的格式，你结合我后面给你的【表格排版】规则，理解它的排列方法。

我之后只会给你要处理的PDF文件。然后，按照以下方式，处理我提供给你的的PDF文件。

2. 提取数据：将PDF的数据识别出来，从PDF的各个页面提取“品种合约”、“净持仓”、“增减”数据。对于“品种合约”按照“期货数据全表”进行识别，如果PDF识别到某品种而“期货数据全表”没有此品种，第一时间给用户发出提示；修正明显的输入错误，例如“采油”修正为“菜油”。根据用户提供的品种列表未找到品种数据，其“净持仓”、“增减”数据用“-”填充
对于提取的数据，包含“品种合约”、“净持仓”、“增减”三列。正持仓按净持仓值从大到小排列，负持仓按绝对值从大到小排列，根据用户提供的品种列表未找到品种数据列在末尾，其对应数据用“-”填充。

3. 数据清洗与验证：
- 检查数值格式，确保千位分隔符正确。

4. 排序与分类
 - 将品种分为正持仓和负持仓两类。
- 正持仓按净持仓值从大到小排序。
- 负持仓按绝对值从大到小排序。

5. 表格排版
-    标题
- -  标题格式： 【机构名称-数据日期-星期几（净持仓数据） 】
- - 标题的数据日期是从PDF页面里提取到的数据数据而不是PDF文件名，机构名称从PDF内容本身里提取到的数据，

- 表格内容
- - 为了方便表格展示，需要将数据按左右2栏分布的方式排布，即最后的表格总共6列，品种合约”、“净持仓”、“增减”，品种合约”、“净持仓”、“增减” 这样分布，以便可以更宽的进行打印。

- - 你在填充表格的时候，不要简单的，左边填充正数据，右边边填充负数据。而是先在左边的一个单元格填充【净持仓为正】，然后从下一行开始，交替填充左右两栏以优化空间利用，正持仓按净持仓值从大到小排列，这里你可能要面临如何计算出需要的行数。然后填充【净持仓为负】的数据，负持仓按绝对值从大到小排进行左右交替填充。最后填充【未找到品种】的数据。


<!-- 考虑直接给GPT提供excel数据模版以便更精确展示数据。 效果不好，或许给markdown的格式其更能理解？不再测试这个--> 

6. 不同GPT的兼容性法则：（for chatgpt dataanalyst）：如果你是deepseek，则忽略本规则。
- 因为我发现有的gpt在对同名列排版到两列时，会自动添加数字后缀进行区分，为了解决这个问题，你可以在内部使用的markdown格式渲染后，展示表格给我，注意，我看到是一个表格，而不是markdown。

